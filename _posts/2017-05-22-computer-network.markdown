---
layout:     post
title:      "计算机网络"
subtitle:   "第3章 数据链路层"
date:       2017-05-22 12:00:00
author:     "HE"
header-img: "img/home-bg.jpg"
header-mask: 0.3
catalog:    true
tags:
    - 计算机网络
    - 基础知识
---

数据链路层使用的信道主要是以下两种类型：

1. **点对点信道**——使用一对一的点对点通信方式
2. **广播信道**——使用一对多的广播通信方式

### 点对点信道的数据链路层

##### 数据链路和帧

**链路**就是从一个结点到相邻结点的一端物理链路，而中间没有任何其他的交换结点

**数据链路**除了物理线路外，还必须有一些必要的通信协议来控制这些数据的传输

点对点的信道的数据链路层在进行通信时的主要步骤：
1. 结点A的数据链路层把网络层交下来的IP数据报添加首部和尾部封装成帧
2. 结点A把封装好的帧发送给结点B的数据链路层
3. 若结点B的数据链路层收到的帧无差错，则从收到的帧中提取出IP数据报上交给上面的网络层；否则丢弃这个帧

![点对点通信的数据链路层](/img/computer-network/PPP-data-link.png)

##### 三个基本问题

* **封装成帧**：就是在一段数据的前后分别添加首部和尾部。网络层的IP数据报传送到数据链路层就称为帧的数据部分。帧长等于数据部分的长度加上帧首部和帧尾部的长度，而首部和尾部的一个重要作用就是进行帧定界（确定帧的界限）
![帧首部和帧尾部封装成帧](/img/computer-network/frame-structure.png)
控制字符SOH（Start Of Header）表示帧的首部开始，控制字符EOT（End Of Transmission）表示帧的结束
![控制字符进行帧定界](/img/computer-network/SOH-EOT.png)

* **透明传输**：所传输的数据中的任何8比特的组合都可以放在帧中传输过去。如果数据中出现控制字符SOH或EOT，则发送端的数据链路层在数据中出现控制字符的前面插入一个转义字符ESC，而接收端的数据链路层在数据送往网络层之前删除这个插入的转义字符
![透明传输](/img/computer-network/transparent-transmission.png)

* **差错检测**：在发送的码序列中加入适当的冗余度以使得接收端能够发现传输中是否发生差错。数据链路层广泛使用循环冗余检验CRC的检错技术

  在接收端对收到的每一帧经过CRC检验后：
  1. 若得出的余数$$R=0$$，则判定这个帧没有差错，就接受
  2. 若余数$$R\neq0$$，则判定这个帧有差错（但无法确定究竟是哪一位或哪几位出现了差错），就丢弃

  在数据链路层使用CRC检验，能够实现无比特差错的传输，但这还不是可靠传输（可能会出现帧丢失、帧重复、帧失序等问题）

### 点对点协议

##### PPP协议应满足的需求

1. **简单：**接收方每收到一个帧，就进行CRC检验。如果CRC检验正确，就收下这个帧；反之，就丢弃这个帧，其他什么也不做

2. **封装成帧：**规定特殊字符作为帧定界符（标志一个帧的开始和结束的字符），以便使接收端从收到的毕业流中准确地找出帧的开始和结束位置

3. **透明性：**如果数据中碰巧出现了和帧定界符一样的比特组合时，就要采取有效的措施来解决这个问题

4. **多种网络层协议；**PPP协议必须能够在**在同一条物理链路上同时支持多种网络层协议**的运行

5. **多种类型链路：**除了要支持多种网络层的协议外，PPP还必须能够在多种类型的链路上运行

6. **差错检测：**PPP协议必须能够对接收端收到的帧进行检测，并立即丢弃有差错的帧

7. **检测连接状态：**PPP协议必须具有一种机制能够及时自动检测出链路是否处于正常工作状态

8. **最大传送单元：**必须对每一种类型的点对点链路设置最大传送单元MTU的标准默认值。如果高层协议发送的分组过长并超过MTU的数值，PPP就要丢弃这样的帧。MTU是数据链路层的帧可以在和的数据部分的最大长度，而不是帧的总长度

9. **网络层地址协商：**PPP协议必须提供一种机制使通信的两个网络层的实体能够通过协商知道或能够配置彼此的网络层地址

10. **数据压缩协商：**PPP协议必须提供一种方法来协商使用数据压缩算法。但并不要求将数据压缩算法进行标准化

##### PPP协议不需要的功能

1. **纠错：**可靠运输由运输层TCP协议负责，而数据链路层的PPP协议只进行检错。（PPP协议是不可靠传输协议）

2. **流量控制：**端到端的流量控制由TCP负责

3. **序号：**PPP是不可靠传输协议，不需要使用帧序号

4. **多点线路：**不支持多点线路（一个主站轮流和链路上的多个从站进行通信），只支持点对点的链路通信

5. **半双工或单工链路：**PPP协议只支持全双工链路

##### PPP协议的组成

